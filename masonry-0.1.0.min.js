(function(a){a.fn.masonry=function(o){var f=a.extend({startOffset:0,rowMinAspectRatio:3.5},o);function c(i){return parseInt(a(i).attr("width"))}function e(i){return parseInt(a(i).attr("height"))}var j=a(this).find("img");var k=f.startOffset;for(;k<j.length;k++){var m=0;var d=0;var g=k-1;var n=1;do{g++;m+=c(j[g]);d=Math.max(d,e(j[g]));n=Math.max(n,g-k)}while(m/d<f.rowMinAspectRatio&&g<j.length);var l=0;for(var h=0;h<n;h++){l+=c(j[k+h])/e(j[k+h])}a(j[k]).css("clear","left");for(h=0;h<n;h++){var b=((c(j[k+h])/e(j[k+h]))/l)*100;a(j[k+h]).css("width",b+"%").css("height","auto").css("float","left").css("display","block").css("display","block")}k+=(n-1)}return this}}(jQuery));