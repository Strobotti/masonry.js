(function(a){a.fn.masonry=function(p){var g=a.extend({startOffset:0,rowMinAspectRatio:3.5},p);function e(i){return parseInt(a(i).attr("width"))}function f(i){return parseInt(a(i).attr("height"))}function b(i){return e(i)/f(i)}var k=a(this).find("img");var l=g.startOffset;for(;l<k.length;l++){var n=0;var d=0;var h=l-1;var o=1;do{h++;n+=e(k[h]);d=Math.max(d,f(k[h]));o=Math.max(o,h-l)}while(n/d<g.rowMinAspectRatio&&h<k.length);if(k.length-(o+l)==1){if(o>2){o--}else{o++}}var m=0;for(var j=0;j<o;j++){m+=b(k[l+j])}a(k[l]).css("clear","left");for(j=0;j<o;j++){var c=(b(k[l+j])/m)*100;a(k[l+j]).css("width",c+"%").css("height","auto").css("float","left").css("display","block")}l+=(o-1)}return this}}(jQuery));